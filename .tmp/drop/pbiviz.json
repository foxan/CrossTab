{"visual":{"name":"crossTab","displayName":"CrossTab","guid":"PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77","visualClassName":"CrossTab","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.1.0","author":{"name":"","email":""},"assets":{"icon":"assets/icon.png"},"externalJS":[],"style":"style/visual.less","capabilities":{"dataRoles":[{"name":"XAxis","kind":0,"displayName":"X-Axis"},{"name":"YAxis","kind":1,"displayName":"Y-Axis"}],"dataViewMappings":[{"categorical":{"categories":{"for":{"in":"XAxis"},"dataReductionAlgorithm":{"top":{}}},"values":{"select":[{"bind":{"to":"YAxis"}}]}}}],"objects":{"general":{"displayName":"General","properties":{"color1":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Colour 1"},"color1Val":{"type":{"numeric":true},"displayName":"Colour 1 Value"},"color1LegendVal":{"type":{"text":true},"displayName":"Legend 1 Text"},"color2":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Colour 2"},"color2Val":{"type":{"numeric":true},"displayName":"Colour 2 Value"},"color2LegendVal":{"type":{"text":true},"displayName":"Legend 2 Text"},"color3":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Colour 3'"},"color3Val":{"type":{"numeric":true},"displayName":"Colour 3 Value"},"color3LegendVal":{"type":{"text":true},"displayName":"Legend 3 Text"},"color4":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Colour 4"},"color4Val":{"type":{"numeric":true},"displayName":"Colour 4 Value"},"color4LegendVal":{"type":{"text":true},"displayName":"Legend 4 Text"},"color5":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Colour 5"},"color5Val":{"type":{"numeric":true},"displayName":"Colour 5 Value"},"color5LegendVal":{"type":{"text":true},"displayName":"Legend 5 Text"},"showlegend":{"type":{"bool":true},"displayName":"Legend"},"showdata":{"type":{"bool":true},"displayName":"Values In Grid"},"showtotals":{"type":{"bool":true},"displayName":"Show Totals"},"totalscolor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Totals Colour"}}}}},"content":{"js":"var powerbi;!function(t){var e;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t){this.svgSize={width:800,height:300},this.dicColor=[],this.totalsColor=\"#5E5E5E\",this.margin={left:10,right:10,bottom:15,top:15},this.animationDuration=1e3,this.svgSize.height=t.element.clientHeight,this.svgSize.width=t.element.clientWidth,this.svgDiv=d3.select(t.element).append(\"div\").attr(\"style\",\"overflow: auto\").attr(\"class\",\"crossTabContainer\").attr(\"style\",\"height:\"+this.svgSize.height).attr(\"style\",\"width:\"+this.svgSize.width),this.svg=this.svgDiv.append(\"svg\").attr(\"class\",\"svgCrossTab\").attr(\"height\",this.svgSize.height).attr(\"width\",this.svgSize.width),this.selectionManager=t.host.createSelectionManager()}return t.converter=function(t,e,a){if(!(t&&t.categorical&&t.categorical.categories&&t.categorical.categories[0]&&t.categorical.categories[0].values&&t.categorical.categories[0].values.length))return{dataPoints:null};if(!(t.categorical.values&&t.categorical.values[0]&&t.categorical.values[0].values&&t.categorical.values[0].values.length))return{dataPoints:null};var o,r,i,l,n,s,c=[],h=t.metadata,u=t.table,g=[],d=[],f=(t.metadata,[]);if(a)for(var v=1;v<t.table.columns.length;v++){for(var p=0,y=0;y<t.table.rows.length;y++)t.table.rows[y][v]&&\"object\"!=typeof t.table.rows[y][v]&&(p+=t.table.rows[y][v]);p&&t.table.rows.length>0?f.push({categoryX:t.metadata.columns[v].displayName,value:Math.round(p/t.table.rows.length)}):f.push({categoryX:t.metadata.columns[v].displayName,value:null})}for(var m in t.table.rows){o=[],s=[],r=0;for(var w in t.table.columns)if(h.columns[w].isMeasure||(n=d[m]=u.rows[m][w]),h.columns[w].isMeasure){var b,V=u.rows[m][w];void 0!==V&&(l=g[w]=h.columns[w].displayName,h.columns[w].groupName&&(l+=\": \"+h.columns[w].groupName,d[w]+=\": \"+h.columns[w].groupName)),s[r]={value:V,valueStr:b,category:l,fill:null},r++}if(s.forEach(function(t){c.push({categoryY:n,categoryX:t.category,value:t.value,valueStr:t.valueStr,identity:i,fill:t.fill,isTotal:!1})},this),a){var p=0;for(var x in s)s[x].value&&(p+=s[x].value);c.push({categoryY:n,categoryX:\"Total\",value:Math.round(p/s.length),valueStr:null,identity:null,fill:null,isTotal:!0})}}return a&&(f.forEach(function(t){c.push({categoryY:\"Total\",categoryX:t.categoryX,value:t.value,valueStr:null,identity:null,fill:null,isTotal:!0})},this),g.push(\"Total\"),d.push(\"Total\")),{dataPoints:c,categoryX:g.filter(function(t){return void 0!==t}),categoryY:d.filter(function(t){return void 0!==t})}},t.prototype.update=function(t){t.dataViews&&t.dataViews[0]&&(this.svg.selectAll(\"*\").remove(),this.mainGraphics=this.svg,this.setViewportSize(t.viewport),this.updateInternal(t),this.setSVGSize(t.viewport))},t.prototype.updateInternal=function(e){function a(t,e){return e?p:v[t]?v[t].solid.color:\"#E8E8E8\"}function o(t,e){d3.selectAll(\".categoryXLabel\").classed(\"active\",function(e,a){return e==t}),d3.selectAll(\".categoryYLabel\").classed(\"active\",function(t,a){return t==e})}function r(){d3.selectAll(\"text\").classed(\"active\",!1)}var i=this.dataView=e.dataViews[0],l=this.getShowTotals(e.dataViews[0]),n=this.chartData=t.converter(i,this.dicColor,l);if(n.dataPoints){var s=(d3.min(n.dataPoints,function(t){return t.value}),d3.max(n.dataPoints,function(t){return t.value}),10),c=10,h=this.getShowLegend(i),u=28,g=28,d=u+this.margin.left,f=this.margin.top,v=this.dicColor=[],p=this.totalsColor=this.getTotalsColor(i);this.getColors(i),this.mainGraphics.selectAll(\".categoryYLabel\").data(n.categoryY).enter().append(\"text\").text(function(t){return t}).attr(\"dy\",\".71em\").attr(\"x\",this.margin.left).attr(\"y\",function(t,e){return e*g+f/2.5+c}).style(\"text-anchor\",\"start\").attr(\"transform\",\"translate(-6,\"+g+\")\").attr(\"class\",\"categoryYLabel mono axis\").style(\"font-size\",\"6pt\"),this.mainGraphics.selectAll(\".categoryYLabel\").each(function(){s=Math.max(s,this.getComputedTextLength())}),this.mainGraphics.selectAll(\".categoryXLabel\").data(n.categoryX).enter().append(\"text\").text(function(t){return t}).attr(\"transform\",function(t,e){var a=-90;this.getComputedTextLength()/2;return\"translate(\"+(d+s+(e+1)*u)+\", 0)rotate(\"+a+\",0,\"+f+\")\"}).style(\"text-anchor\",\"end\").attr(\"startOffset\",\"100%\").attr(\"dy\",\"-.5em\").attr(\"class\",\"categoryXLabel mono axis\"),this.mainGraphics.selectAll(\".categoryXLabel\").each(function(){c=Math.max(c,this.getComputedTextLength())}),this.mainGraphics.selectAll(\".categoryYLabel\").attr(\"y\",function(t,e){return e*g+f/2.5+c}),this.svgSize.width=u*(n.categoryX.length+1)+s,this.svgSize.height=g*(n.categoryY.length+1)+c,h&&(this.svgSize.height+=g+2*f);var y=(this.selectionManager,this.mainGraphics.selectAll(\".categoryX\").data(n.dataPoints).enter().append(\"rect\").attr(\"x\",function(t,e){return n.categoryX.indexOf(t.categoryX)*u+d+(s-10)}).attr(\"y\",function(t,e){return(n.categoryY.indexOf(t.categoryY)+.5)*g+f+c}).attr(\"class\",\"categoryX bordered\").attr(\"width\",u).attr(\"height\",g).attr(\"rx\",4).attr(\"ry\",4).style(\"stroke\",\"white\").style(\"stroke-width\",1).style(\"fill\",\"#E8E8E8\")),m=this.getAnimationMode(y,!0);m.style(\"fill\",function(t){return a(t.value,t.isTotal)});var w=(this.mainGraphics.selectAll(\".categoryX\").on(\"mouseover\",function(t){d3.select(this).transition().ease(\"elastic\").duration(1e3).attr(\"rx\",8).attr(\"ry\",8),o(t.categoryX,t.categoryY)}).on(\"mouseout\",function(t){d3.select(this).transition().ease(\"elastic\").duration(1e3).attr(\"rx\",4).attr(\"ry\",4),r()}).on(\"click\",function(t){t.selected?(d3.selectAll(\".categoryX\").style(\"opacity\",1),t.selected=null):(d3.selectAll(\".categoryX\").style(\"opacity\",.6),t.selected=!0)}),this.getShowData(i));w?this.mainGraphics.selectAll(\".rectValue\").data(n.dataPoints).enter().append(\"text\").attr(\"x\",function(t,e){return n.categoryX.indexOf(t.categoryX)*u+d+s-25}).attr(\"y\",function(t,e){return(n.categoryY.indexOf(t.categoryY)+.75)*g+f+c-2}).attr(\"dy\",\"1.81em\").style(\"text-anchor\",\"middle\").style(\"fill\",\"White\").attr(\"class\",\"rectValue mono axis bar-text\").attr(\"transform\",\"translate(\"+g+\", -6)\").text(function(t){return t.value?t.value.toString():null}):y.append(\"title\").text(function(t){});var h=this.getShowLegend(i)}},t.prototype.setViewportSize=function(t){var e,a;e=t.height-this.margin.top-this.margin.bottom,a=t.width-this.margin.left-this.margin.right,this.viewport={height:e,width:a},this.mainGraphics.attr(\"height\",Math.max(this.viewport.height+this.margin.top,0)).attr(\"width\",Math.max(this.viewport.width+this.margin.left,0))},t.prototype.setSVGSize=function(t){this.svg.attr(\"height\",this.svgSize.height).attr(\"width\",this.svgSize.width),this.svgDiv.attr(\"style\",\"overflow: auto; height:\"+t.height+\"px; width:\"+t.width+\"px;\")},t.prototype.truncateTextIfNeeded=function(t,e){},t.prototype.getAnimationMode=function(t,e){return e?t:t.transition().duration(this.animationDuration)},t.prototype.getColors=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)for(var o=1;o<=5;o++)a[\"color\"+o]&&a[\"color\"+o+\"Val\"]&&(this.dicColor[a[\"color\"+o+\"Val\"]]=a[\"color\"+o])}}},t.prototype.getColor=function(t,e){if(t){var a=t.metadata.objects;if(a){var o=a.general;if(o&&o[\"color\"+e])return o[\"color\"+e]}}return null},t.prototype.getTotalsColor=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a&&a.totalscolor)return a.totalscolor.solid.color}}return\"#5E5E5E\"},t.prototype.getColorVal=function(t,e){if(t){var a=t.metadata.objects;if(a){var o=a.general;if(o&&o[\"color\"+e+\"Val\"])return o[\"color\"+e+\"Val\"]}}return null},t.prototype.getLegendVal=function(t,e){if(t){var a=t.metadata.objects;if(a){var o=a.general;if(o&&o[\"color\"+e+\"LegendVal\"])return o[\"color\"+e+\"LegendVal\"]}}return null},t.prototype.getShowData=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)return a.showdata}}return!1},t.prototype.getShowLegend=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)return a.showlegend}}return!1},t.prototype.getShowTotals=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)return a.showtotals}}return!1},t.prototype.enumerateObjectInstances=function(t){var e=[],a=this.dataView;t.objectName;switch(t.objectName){case\"general\":e.push({objectName:\"general\",displayName:\"General\",selector:null,properties:{color1:this.getColor(a,\"1\"),color1Val:this.getColorVal(a,\"1\"),color1LegendVal:this.getLegendVal(a,\"1\"),color2:this.getColor(a,\"2\"),color2Val:this.getColorVal(a,\"2\"),color2LegendVal:this.getLegendVal(a,\"2\"),color3:this.getColor(a,\"3\"),color3Val:this.getColorVal(a,\"3\"),color3LegendVal:this.getLegendVal(a,\"3\"),color4:this.getColor(a,\"4\"),color4Val:this.getColorVal(a,\"4\"),color4LegendVal:this.getLegendVal(a,\"4\"),color5:this.getColor(a,\"5\"),color5Val:this.getColorVal(a,\"5\"),color5LegendVal:this.getLegendVal(a,\"5\"),showdata:this.getShowData(a),showlegend:this.getShowLegend(a),showtotals:this.getShowTotals(a),totalscolor:this.getTotalsColor(a)}});break;case\"dataPoint\":this.dataView&&this.enumerateDataPoints(e,t)}return e},t.prototype.enumerateDataPoints=function(t,e){var a=this.chartData;if(a){a.dataPoints.length}},t.Properties={general:{},dataPoint:{defaultColor:{objectName:\"dataPoint\",propertyName:\"defaultColor\"},fill:{objectName:\"dataPoint\",propertyName:\"fill\"},value:{objectName:\"dataPoint\",propertyName:\"value\"}},labels:{labelPrecision:{objectName:\"labels\",propertyName:\"labelPrecision\"}}},t}();t.CrossTab=e}(e=t.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77||(t.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77={}))}(e=t.visual||(t.visual={}))}(e=t.extensibility||(t.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(t){var e;!function(e){var a;!function(e){e.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77={name:\"PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77\",displayName:\"CrossTab\",class:\"CrossTab\",version:\"1.0.0\",apiVersion:\"1.1.0\",create:function(e){return new t.extensibility.visual.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77.CrossTab(e)},custom:!0}}(a=e.plugins||(e.plugins={}))}(e=t.visuals||(t.visuals={}))}(powerbi||(powerbi={}));","css":".visual-PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77 text.mono{font-size:8pt !important;font-family:Consolas,courier;fill:#000}.visual-PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77 text.active{fill:red}.visual-PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77 .bar-text{pointer-events:none}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="}}