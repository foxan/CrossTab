var powerbi;!function(t){var e;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t){this.svgSize={width:800,height:300},this.dicColor=[],this.totalsColor="#5E5E5E",this.overrideDimensionColor="#FF6363",this.margin={left:10,right:10,bottom:15,top:15},this.animationDuration=1e3,this.host=t.host,this.svgSize.height=t.element.clientHeight,this.svgSize.width=t.element.clientWidth,this.svgDiv=d3.select(t.element).append("div").attr("style","overflow: auto").attr("class","crossTabContainer").attr("style","height:"+this.svgSize.height).attr("style","width:"+this.svgSize.width),this.svg=this.svgDiv.append("svg").attr("class","svgCrossTab").attr("height",this.svgSize.height).attr("width",this.svgSize.width),this.selectionManager=t.host.createSelectionManager()}return t.visualTransform=function(t,e,a){if(!(t&&t&&t.categorical&&t.categorical.categories&&t.categorical.categories[0].source&&t.categorical.values))return{datapoints:null};for(var o=[],r=(t.metadata,t.table,[]),i=[],l=(t.metadata,t.categorical),s=(l.categories[0],l.values[0],0);s<t.categorical.categories[0].values.length;s++)r.push(t.categorical.categories[0].values[s]);for(var s=0;s<t.categorical.values.length;s++)if(t.categorical.values[s].source&&t.categorical.values[s].source.roles&&t.categorical.values[s].source.roles.Values){var n=t.categorical.values[s].source.groupName,c=0;i.push(n);for(var h=0;h<t.categorical.values[s].values.length;h++){var g;g=t.categorical.values[s].values[h]?t.categorical.values[s].values[h]:0,c+=g;var u=!1;t.categorical.values[s+1]&&t.categorical.values[s+1].values[h]&&1===t.categorical.values[s+1].values[h]&&(u=t.categorical.values[s+1].values[h]),o.push({categoryY:n,categoryX:r[h],overrideDimension:u,value:g,identity:e.createSelectionIdBuilder().withSeries(l.values,l.values[s]).createSelectionId(),fill:null,isTotal:!1,selected:!1})}a&&o.push({categoryY:n,categoryX:"Total",overrideDimension:!1,value:Math.round(c/t.categorical.values[s].values.length),identity:null,fill:null,isTotal:!0,selected:!1})}if(a)for(var d=0;d<t.categorical.values[0].values.length;d++){for(var v=0,s=0;s<t.categorical.values.length;s++)t.categorical.values[s].values&&void 0!==t.categorical.values[s].values[d]&&(v+=t.categorical.values[s].values[d]);o.push({categoryY:"Total",categoryX:t.categorical.categories[0].values[d],overrideDimension:!1,value:Math.round(v/t.categorical.values.length),identity:null,fill:null,isTotal:!0,selected:!1})}return a&&(r.push("Total"),i.push("Total")),{dataPoints:o,categoryX:r.filter(function(t){return void 0!==t}),categoryY:i.filter(function(t){return void 0!==t})}},t.prototype.update=function(t){t.dataViews&&t.dataViews[0]&&(this.svg.selectAll("*").remove(),this.mainGraphics=this.svg,this.setViewportSize(t.viewport),this.updateInternal(t),this.setSVGSize(t.viewport))},t.prototype.updateInternal=function(e){function a(t,e,a){return a?m:e?p:f[t]?f[t].solid.color:"#E8E8E8"}function o(t,e){d3.selectAll(".categoryXLabel").classed("active",function(e,a){return e==t}),d3.selectAll(".categoryYLabel").classed("active",function(t,a){return t==e})}function r(){d3.selectAll("text").classed("active",!1)}var i=this.dataView=e.dataViews[0],l=this.getShowTotals(e.dataViews[0]),s=this.chartData=t.visualTransform(i,this.host,l);if(s.dataPoints){var n=(d3.min(s.dataPoints,function(t){return t.value}),d3.max(s.dataPoints,function(t){return t.value}),10),c=10,h=this.getShowLegend(i),g=28,u=28,d=g+this.margin.left,v=this.margin.top,f=this.dicColor=[],p=this.totalsColor=this.getTotalsColor(i),m=this.overrideDimensionColor=this.getOverrideDemensionColor(i);this.getColors(i),this.mainGraphics.selectAll(".categoryYLabel").data(s.categoryY).enter().append("text").text(function(t){return t}).attr("dy",".71em").attr("x",this.margin.left).attr("y",function(t,e){return e*u+v/2.5+c}).style("text-anchor","start").attr("transform","translate(-6,"+u+")").attr("class","categoryYLabel mono axis").style("font-size","6pt"),this.mainGraphics.selectAll(".categoryYLabel").each(function(){n=Math.max(n,this.getComputedTextLength())}),this.mainGraphics.selectAll(".categoryXLabel").data(s.categoryX).enter().append("text").text(function(t){return t}).attr("transform",function(t,e){var a=-90;this.getComputedTextLength()/2;return"translate("+(d+n+(e+1)*g)+", 0)rotate("+a+",0,"+v+")"}).style("text-anchor","end").attr("startOffset","100%").attr("dy","-.5em").attr("class","categoryXLabel mono axis"),this.mainGraphics.selectAll(".categoryXLabel").each(function(){c=Math.max(c,this.getComputedTextLength())}),this.mainGraphics.selectAll(".categoryYLabel").attr("y",function(t,e){return e*u+v/2.5+c}),this.svgSize.width=g*(s.categoryX.length+1)+n,this.svgSize.height=u*(s.categoryY.length+1)+c,h&&(this.svgSize.height+=u+2*v);var y=this.selectionManager,w=this.mainGraphics.selectAll(".categoryX").data(s.dataPoints).enter().append("rect").attr("x",function(t,e){return s.categoryX.indexOf(t.categoryX)*g+d+(n-10)}).attr("y",function(t,e){return(s.categoryY.indexOf(t.categoryY)+.5)*u+v+c}).attr("class","categoryX bordered").attr("width",g).attr("height",u).attr("rx",4).attr("ry",4).style("stroke","white").style("stroke-width",1).style("fill","#E8E8E8"),C=this.getAnimationMode(w,!0);C.style("fill",function(t){return a(t.value,t.isTotal,t.overrideDimension)});var b=(this.mainGraphics.selectAll(".categoryX").on("mouseover",function(t){d3.select(this).transition().ease("elastic").duration(1e3).attr("rx",8).attr("ry",8),o(t.categoryX,t.categoryY),d3.event.stopPropagation()}).on("mouseout",function(t){d3.select(this).transition().ease("elastic").duration(1e3).attr("rx",4).attr("ry",4),r(),d3.event.stopPropagation()}).on("click",function(t){var e=this;t.selected?(d3.selectAll(".categoryX").style("opacity",1),t.selected=!1,y.clear()):(d3.selectAll(".categoryX").style("opacity",.6),y.select(t.identity).then(function(t){return d3.select(e).style("opacity",1)}),t.selected=!0),d3.event.stopPropagation()}),this.getShowData(i));b?this.mainGraphics.selectAll(".rectValue").data(s.dataPoints).enter().append("text").attr("x",function(t,e){return s.categoryX.indexOf(t.categoryX)*g+d+n-25}).attr("y",function(t,e){return(s.categoryY.indexOf(t.categoryY)+.75)*u+v+c-2}).attr("dy","1.81em").style("text-anchor","middle").style("fill","White").attr("class","rectValue mono axis bar-text").attr("transform","translate("+u+", -6)").text(function(t){return t.value?t.value.toString():null}):w.append("title").text(function(t){});var h=this.getShowLegend(i)}},t.prototype.setViewportSize=function(t){var e,a;e=t.height-this.margin.top-this.margin.bottom,a=t.width-this.margin.left-this.margin.right,this.viewport={height:e,width:a},this.mainGraphics.attr("height",Math.max(this.viewport.height+this.margin.top,0)).attr("width",Math.max(this.viewport.width+this.margin.left,0))},t.prototype.setSVGSize=function(t){this.svg.attr("height",this.svgSize.height).attr("width",this.svgSize.width),this.svgDiv.attr("style","overflow: auto; height:"+t.height+"px; width:"+t.width+"px;")},t.prototype.truncateTextIfNeeded=function(t,e){},t.prototype.getAnimationMode=function(t,e){return e?t:t.transition().duration(this.animationDuration)},t.prototype.getColors=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)for(var o=0;o<=10;o++)a["color"+o]&&a["color"+o+"Val"]&&(this.dicColor[a["color"+o+"Val"]]=a["color"+o])}}},t.prototype.getColor=function(t,e){if(t){var a=t.metadata.objects;if(a){var o=a.general;if(o&&o["color"+e])return o["color"+e]}}return null},t.prototype.getTotalsColor=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a&&a.totalscolor)return a.totalscolor.solid.color}}return"#5E5E5E"},t.prototype.getOverrideDemensionColor=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a&&a.overridedimensioncolor)return a.overridedimensioncolor.solid.color}}return"#FF6363"},t.prototype.getColorVal=function(t,e){if(t){var a=t.metadata.objects;if(a){var o=a.general;if(o&&o["color"+e+"Val"])return o["color"+e+"Val"]}}return null},t.prototype.getLegendVal=function(t,e){if(t){var a=t.metadata.objects;if(a){var o=a.general;if(o&&o["color"+e+"LegendVal"])return o["color"+e+"LegendVal"]}}return null},t.prototype.getShowData=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)return a.showdata}}return!1},t.prototype.getShowLegend=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)return a.showlegend}}return!1},t.prototype.getShowTotals=function(t){if(t){var e=t.metadata.objects;if(e){var a=e.general;if(a)return a.showtotals}}return!1},t.prototype.enumerateObjectInstances=function(t){var e=[],a=this.dataView;t.objectName;switch(t.objectName){case"general":e.push({objectName:"general",displayName:"General",selector:null,properties:{color1:this.getColor(a,"1"),color1Val:this.getColorVal(a,"1"),color2:this.getColor(a,"2"),color2Val:this.getColorVal(a,"2"),color3:this.getColor(a,"3"),color3Val:this.getColorVal(a,"3"),color4:this.getColor(a,"4"),color4Val:this.getColorVal(a,"4"),color5:this.getColor(a,"5"),color5Val:this.getColorVal(a,"5"),color6:this.getColor(a,"6"),color6Val:this.getColorVal(a,"6"),color7:this.getColor(a,"7"),color7Val:this.getColorVal(a,"7"),color8:this.getColor(a,"8"),color8Val:this.getColorVal(a,"8"),color9:this.getColor(a,"9"),color9Val:this.getColorVal(a,"9"),color10:this.getColor(a,"10"),color10Val:this.getColorVal(a,"10"),overridedimensioncolor:this.getOverrideDemensionColor(a),showdata:this.getShowData(a),showlegend:this.getShowLegend(a),showtotals:this.getShowTotals(a),totalscolor:this.getTotalsColor(a)}});break;case"dataPoint":this.dataView&&this.enumerateDataPoints(e,t)}return e},t.prototype.enumerateDataPoints=function(t,e){var a=this.chartData;if(a){a.dataPoints.length}},t.Properties={general:{},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},value:{objectName:"dataPoint",propertyName:"value"}},labels:{labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}}},t}();t.CrossTab=e}(e=t.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77||(t.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77={}))}(e=t.visual||(t.visual={}))}(e=t.extensibility||(t.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(t){var e;!function(e){var a;!function(e){e.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77={name:"PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77",displayName:"CrossTab",class:"CrossTab",version:"1.0.0",apiVersion:"1.1.0",create:function(e){return new t.extensibility.visual.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77.CrossTab(e)},custom:!0}}(a=e.plugins||(e.plugins={}))}(e=t.visuals||(t.visuals={}))}(powerbi||(powerbi={}));