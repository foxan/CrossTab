var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this.svgSize={width:800,height:300},this.dicColor=[],this.totalsColor="#5E5E5E",this.overrideDimensionColor="#FF6363",this.borderDimensionColor="#FF6363",this.timelineDimensionColor="#0033FF",this.margin={left:10,right:10,bottom:15,top:15},this.animationDuration=1e3,this.host=e.host,this.svgSize.height=e.element.clientHeight,this.svgSize.width=e.element.clientWidth,this.svgDiv=d3.select(e.element).append("div").attr("style","overflow: auto").attr("class","crossTabContainer").attr("style","height:"+this.svgSize.height).attr("style","width:"+this.svgSize.width),this.svg=this.svgDiv.append("svg").attr("class","svgCrossTab").attr("height",this.svgSize.height).attr("width",this.svgSize.width),this.selectionManager=e.host.createSelectionManager()}return e.visualTransform=function(e,t,o){if(!(e&&e&&e.categorical&&e.categorical.categories&&e.categorical.categories[0].source&&e.categorical.values))return{datapoints:null};for(var i=[],a=(e.metadata,e.table,[]),r=[],l=(e.metadata,e.categorical),n=(l.categories[0],l.values[0],0);n<e.categorical.categories[0].values.length;n++)a.push(e.categorical.categories[0].values[n]);for(var n=0;n<e.categorical.values.length;n++)if(e.categorical.values[n].source&&e.categorical.values[n].source.roles&&e.categorical.values[n].source.roles.Values){var s=e.categorical.values[n].source.groupName,c=0;r.push(s);for(var u=0;u<e.categorical.values[n].values.length;u++){var g={categoryY:s,categoryX:a[u],overrideDimension:!1,borderDimension:!1,timelineDimension:!1,value:null,identity:t.createSelectionIdBuilder().withSeries(l.values,l.values[n]).createSelectionId(),fill:null,isTotal:!1,selected:!1};e.categorical.values[n].values[u]?g.value=e.categorical.values[n].values[u]:g.value=0,c+=g.value,e.categorical.values[n+1]&&e.categorical.values[n+1].values[u]&&1===e.categorical.values[n+1].values[u]&&e.categorical.values[n+1].source.groupName===e.categorical.values[n].source.groupName&&(e.categorical.values[n+1].source.roles.OverrideDimension===!0?g.overrideDimension=!0:e.categorical.values[n+1].source.roles.BorderDimension===!0?g.borderDimension=!0:e.categorical.values[n+1].source.roles.TimelineDimension===!0&&(g.timelineDimension=!0)),e.categorical.values[n+2]&&e.categorical.values[n+2].values[u]&&1===e.categorical.values[n+2].values[u]&&e.categorical.values[n+2].source.groupName===e.categorical.values[n].source.groupName&&(e.categorical.values[n+2].source.roles.OverrideDimension===!0?g.overrideDimension=!0:e.categorical.values[n+2].source.roles.BorderDimension===!0?g.borderDimension=!0:e.categorical.values[n+2].source.roles.TimelineDimension===!0&&(g.timelineDimension=!0)),e.categorical.values[n+3]&&e.categorical.values[n+3].values[u]&&1===e.categorical.values[n+3].values[u]&&e.categorical.values[n+3].source.groupName===e.categorical.values[n].source.groupName&&(e.categorical.values[n+3].source.roles.OverrideDimension===!0?g.overrideDimension=!0:e.categorical.values[n+3].source.roles.BorderDimension===!0?g.borderDimension=!0:e.categorical.values[n+3].source.roles.TimelineDimension===!0&&(g.timelineDimension=!0)),i.push(g)}o&&i.push({categoryY:s,categoryX:"Total",overrideDimension:!1,borderDimension:!1,timelineDimension:!1,value:Math.round(c/e.categorical.values[n].values.length),identity:null,fill:null,isTotal:!0,selected:!1})}if(o)for(var h=0;h<e.categorical.values[0].values.length;h++){for(var v=0,n=0;n<e.categorical.values.length;n++)e.categorical.values[n].values&&void 0!==e.categorical.values[n].values[h]&&(v+=e.categorical.values[n].values[h]);i.push({categoryY:"Total",categoryX:e.categorical.categories[0].values[h],overrideDimension:!1,borderDimension:!1,timelineDimension:!1,value:Math.round(v/e.categorical.values.length),identity:null,fill:null,isTotal:!0,selected:!1})}return o&&(a.push("Total"),r.push("Total")),{dataPoints:i,categoryX:a.filter(function(e){return void 0!==e}),categoryY:r.filter(function(e){return void 0!==e})}},e.prototype.update=function(e){e.dataViews&&e.dataViews[0]&&(this.svg.selectAll("*").remove(),this.mainGraphics=this.svg,this.setViewportSize(e.viewport),this.updateInternal(e),this.setSVGSize(e.viewport))},e.prototype.updateInternal=function(t){function o(e,t,o,i,a){return o?s:t?n:D[e]?D[e].solid.color:"#E8E8E8"}function i(e,t){d3.selectAll(".categoryXLabel").classed("active",function(t,o){return t==e}),d3.selectAll(".categoryYLabel").classed("active",function(e,o){return e==t})}function a(){d3.selectAll("text").classed("active",!1)}var r=this.dataView=t.dataViews[0],l=this.getShowTotals(t.dataViews[0]),n=this.totalsColor=this.getTotalsColor(r),s=this.overrideDimensionColor=this.getOverrideDimensionColor(r),c=this.borderDimensionColor=this.getBorderDimensionColor(r),u=this.timelineDimensionColor=this.getTimelineDimensionColor(r),g=this.chartData=e.visualTransform(r,this.host,l);if(g.dataPoints){var h=(d3.min(g.dataPoints,function(e){return e.value}),d3.max(g.dataPoints,function(e){return e.value}),10),v=10,d=this.getShowLegend(r),m=28,f=28,p=m+this.margin.left,y=this.margin.top,D=this.dicColor=[];this.getColors(r),this.mainGraphics.selectAll(".categoryYLabel").data(g.categoryY).enter().append("text").text(function(e){return e}).attr("dy",".71em").attr("x",this.margin.left).attr("y",function(e,t){return t*f+y/2.5+v}).style("text-anchor","start").attr("transform","translate(-6,"+f+")").attr("class","categoryYLabel mono axis").style("font-size","6pt"),this.mainGraphics.selectAll(".categoryYLabel").each(function(){h=Math.max(h,this.getComputedTextLength())}),this.mainGraphics.selectAll(".categoryXLabel").data(g.categoryX).enter().append("text").text(function(e){return e}).attr("transform",function(e,t){var o=-90;this.getComputedTextLength()/2;return"translate("+(p+h+(t+1)*m)+", 0)rotate("+o+",0,"+y+")"}).style("text-anchor","end").attr("startOffset","100%").attr("dy","-.5em").attr("class","categoryXLabel mono axis"),this.mainGraphics.selectAll(".categoryXLabel").each(function(){v=Math.max(v,this.getComputedTextLength())}),this.mainGraphics.selectAll(".categoryYLabel").attr("y",function(e,t){return t*f+y/2.5+v}),this.svgSize.width=m*(g.categoryX.length+1)+h,this.svgSize.height=f*(g.categoryY.length+1)+v,d&&(this.svgSize.height+=f+2*y);var C=this.selectionManager,b=this.mainGraphics.selectAll(".categoryX").data(g.dataPoints).enter().append("rect").attr("x",function(e,t){return g.categoryX.indexOf(e.categoryX)*m+p+(h-10)}).attr("y",function(e,t){return(g.categoryY.indexOf(e.categoryY)+.5)*f+y+v}).attr("class","categoryX bordered").attr("width",m-1).attr("height",f-1).attr("rx",4).attr("ry",4).style("stroke",function(e,t){return 1==e.borderDimension?c:"White"}).style("stroke-width",1).style("fill","#E8E8E8");this.mainGraphics.selectAll(".timelineDimension").data(g.dataPoints).enter().append("line").attr("visibility",function(e,t){return 1==e.timelineDimension?"visible":"hidden"}).style("stroke",function(e,t){return u}).attr("x1",function(e,t){return g.categoryX.indexOf(e.categoryX)*m+p+(h-10)+28}).attr("y1",function(e,t){return(g.categoryY.indexOf(e.categoryY)+.5)*f+y+v}).attr("x2",function(e,t){return g.categoryX.indexOf(e.categoryX)*m+p+(h-10)+28}).attr("y2",function(e,t){return(g.categoryY.indexOf(e.categoryY)+.5)*f+y+v+28});d3.selectAll("line[visibility=hidden]").remove();var w=this.getAnimationMode(b,!0);w.style("fill",function(e){return o(e.value,e.isTotal,e.overrideDimension,e.borderDimension,e.timelineDimension)});var V=(this.mainGraphics.selectAll(".categoryX").on("mouseover",function(e){d3.select(this).transition().ease("elastic").duration(1e3).attr("rx",8).attr("ry",8),i(e.categoryX,e.categoryY),d3.event.stopPropagation()}).on("mouseout",function(e){d3.select(this).transition().ease("elastic").duration(1e3).attr("rx",4).attr("ry",4),a(),d3.event.stopPropagation()}).on("click",function(e){var t=this;e.selected?(d3.selectAll(".categoryX").style("opacity",1),e.selected=!1,C.clear()):(d3.selectAll(".categoryX").style("opacity",.6),C.select(e.identity).then(function(e){return d3.select(t).style("opacity",1)}),e.selected=!0),d3.event.stopPropagation()}),this.getShowData(r));V?this.mainGraphics.selectAll(".rectValue").data(g.dataPoints).enter().append("text").attr("x",function(e,t){return g.categoryX.indexOf(e.categoryX)*m+p+h-25}).attr("y",function(e,t){return(g.categoryY.indexOf(e.categoryY)+.75)*f+y+v-2}).attr("dy","1.81em").style("text-anchor","middle").style("fill","White").attr("class","rectValue mono axis bar-text").attr("transform","translate("+f+", -6)").text(function(e){return e.value?e.value.toString():null}):b.append("title").text(function(e){});var d=this.getShowLegend(r)}},e.prototype.setViewportSize=function(e){var t,o;t=e.height-this.margin.top-this.margin.bottom,o=e.width-this.margin.left-this.margin.right,this.viewport={height:t,width:o},this.mainGraphics.attr("height",Math.max(this.viewport.height+this.margin.top,0)).attr("width",Math.max(this.viewport.width+this.margin.left,0))},e.prototype.setSVGSize=function(e){this.svg.attr("height",this.svgSize.height).attr("width",this.svgSize.width),this.svgDiv.attr("style","overflow: auto; height:"+e.height+"px; width:"+e.width+"px;")},e.prototype.truncateTextIfNeeded=function(e,t){},e.prototype.getAnimationMode=function(e,t){return t?e:e.transition().duration(this.animationDuration)},e.prototype.getColors=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o)for(var i=0;i<=10;i++)o["color"+i]&&o["color"+i+"Val"]&&(this.dicColor[o["color"+i+"Val"]]=o["color"+i])}}},e.prototype.getColor=function(e,t){if(e){var o=e.metadata.objects;if(o){var i=o.general;if(i&&i["color"+t])return i["color"+t]}}return null},e.prototype.getTotalsColor=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o&&o.totalsColor)return o.totalsColor.solid.color}}return"#5E5E5E"},e.prototype.getOverrideDimensionColor=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o&&o.overrideDimensionColor)return o.overrideDimensionColor.solid.color}}return"#FF6363"},e.prototype.getBorderDimensionColor=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o&&o.borderDimensionColor)return o.borderDimensionColor.solid.color}}return"#FF6363"},e.prototype.getTimelineDimensionColor=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o&&o.timelineDimensionColor)return o.timelineDimensionColor.solid.color}}return"#FF6363"},e.prototype.getColorVal=function(e,t){if(e){var o=e.metadata.objects;if(o){var i=o.general;if(i&&i["color"+t+"Val"])return i["color"+t+"Val"]}}return null},e.prototype.getLegendVal=function(e,t){if(e){var o=e.metadata.objects;if(o){var i=o.general;if(i&&i["color"+t+"LegendVal"])return i["color"+t+"LegendVal"]}}return null},e.prototype.getShowData=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o)return o.showData}}return!1},e.prototype.getShowLegend=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o)return o.showLegend}}return!1},e.prototype.getShowTotals=function(e){if(e){var t=e.metadata.objects;if(t){var o=t.general;if(o)return o.showTotals}}return!1},e.prototype.enumerateObjectInstances=function(e){var t=[],o=this.dataView;e.objectName;switch(e.objectName){case"general":t.push({objectName:"general",displayName:"General",selector:null,properties:{color1:this.getColor(o,"1"),color1Val:this.getColorVal(o,"1"),color2:this.getColor(o,"2"),color2Val:this.getColorVal(o,"2"),color3:this.getColor(o,"3"),color3Val:this.getColorVal(o,"3"),color4:this.getColor(o,"4"),color4Val:this.getColorVal(o,"4"),color5:this.getColor(o,"5"),color5Val:this.getColorVal(o,"5"),color6:this.getColor(o,"6"),color6Val:this.getColorVal(o,"6"),color7:this.getColor(o,"7"),color7Val:this.getColorVal(o,"7"),color8:this.getColor(o,"8"),color8Val:this.getColorVal(o,"8"),color9:this.getColor(o,"9"),color9Val:this.getColorVal(o,"9"),color10:this.getColor(o,"10"),color10Val:this.getColorVal(o,"10"),overrideDimensionColor:this.getOverrideDimensionColor(o),borderDimensionColor:this.getBorderDimensionColor(o),timelineDimensionColor:this.getTimelineDimensionColor(o),showData:this.getShowData(o),showLegend:this.getShowLegend(o),showTotals:this.getShowTotals(o),totalsColor:this.getTotalsColor(o)}});break;case"dataPoint":this.dataView&&this.enumerateDataPoints(t,e)}return t},e.prototype.enumerateDataPoints=function(e,t){var o=this.chartData;if(o){o.dataPoints.length}},e.Properties={general:{},dataPoint:{defaultColor:{objectName:"dataPoint",propertyName:"defaultColor"},fill:{objectName:"dataPoint",propertyName:"fill"},value:{objectName:"dataPoint",propertyName:"value"}},labels:{labelPrecision:{objectName:"labels",propertyName:"labelPrecision"}}},e}();e.CrossTab=t}(t=e.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77||(e.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var o;!function(t){t.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77={name:"PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77",displayName:"CrossTab",class:"CrossTab",version:"1.0.0",apiVersion:"1.1.0",create:function(t){return new e.extensibility.visual.PBI_CV_522F2011_DD5A_44D2_A8ED_456F3931DF77.CrossTab(t)},custom:!0}}(o=t.plugins||(t.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));